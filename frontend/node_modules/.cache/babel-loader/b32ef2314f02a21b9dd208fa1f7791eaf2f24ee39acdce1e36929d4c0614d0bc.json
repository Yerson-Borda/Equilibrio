{"ast":null,"code":"// ✅ No absolute URL — use relative path to trigger CRA proxy\nconst API_BASE_URL = '/api/v1';\nclass ApiService {\n  constructor() {\n    this.token = localStorage.getItem('token');\n  }\n  setToken(token) {\n    this.token = token;\n    localStorage.setItem('token', token);\n  }\n  getAuthHeaders() {\n    return {\n      'Content-Type': 'application/json',\n      ...(this.token && {\n        'Authorization': `Bearer ${this.token}`\n      })\n    };\n  }\n  async handleResponse(response) {\n    const text = await response.text();\n    let data;\n    try {\n      data = text ? JSON.parse(text) : {};\n    } catch {\n      data = {};\n    }\n    if (!response.ok) {\n      var _data, _data2;\n      throw {\n        status: response.status,\n        message: ((_data = data) === null || _data === void 0 ? void 0 : _data.detail) || 'An error occurred',\n        errors: ((_data2 = data) === null || _data2 === void 0 ? void 0 : _data2.detail) || []\n      };\n    }\n    return data;\n  }\n\n  // LOGIN (backend expects query params)\n  async login(email, password) {\n    const url = new URL(`${API_BASE_URL}/users/login`, window.location.origin);\n    url.searchParams.append('email', email);\n    url.searchParams.append('password', password);\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: this.getAuthHeaders()\n    });\n    const data = await this.handleResponse(response);\n    if (data.access_token) this.setToken(data.access_token);\n    return data;\n  }\n\n  // REGISTER (backend expects JSON)\n  async register(fullName, email, password) {\n    const body = {\n      email,\n      password,\n      full_name: fullName || null\n    };\n    const response = await fetch(`${API_BASE_URL}/users/register`, {\n      method: 'POST',\n      headers: this.getAuthHeaders(),\n      body: JSON.stringify(body)\n    });\n    return this.handleResponse(response);\n  }\n  async getCurrentUser() {\n    const response = await fetch(`${API_BASE_URL}/users/me`, {\n      method: 'GET',\n      headers: this.getAuthHeaders()\n    });\n    return this.handleResponse(response);\n  }\n  async getWallets() {\n    const response = await fetch(`${API_BASE_URL}/wallets/`, {\n      method: 'GET',\n      headers: this.getAuthHeaders()\n    });\n    return this.handleResponse(response);\n  }\n  async createWallet(walletData) {\n    const response = await fetch(`${API_BASE_URL}/wallets/`, {\n      method: 'POST',\n      headers: this.getAuthHeaders(),\n      body: JSON.stringify(walletData)\n    });\n    return this.handleResponse(response);\n  }\n  async getWallet(walletId) {\n    const response = await fetch(`${API_BASE_URL}/wallets/${walletId}`, {\n      method: 'GET',\n      headers: this.getAuthHeaders()\n    });\n    return this.handleResponse(response);\n  }\n}\nexport const apiService = new ApiService();","map":{"version":3,"names":["API_BASE_URL","ApiService","constructor","token","localStorage","getItem","setToken","setItem","getAuthHeaders","handleResponse","response","text","data","JSON","parse","ok","_data","_data2","status","message","detail","errors","login","email","password","url","URL","window","location","origin","searchParams","append","fetch","method","headers","access_token","register","fullName","body","full_name","stringify","getCurrentUser","getWallets","createWallet","walletData","getWallet","walletId","apiService"],"sources":["C:/Users/aswad/Downloads/Development project/Frontend/frontend/src/services/api.jsx"],"sourcesContent":["// ✅ No absolute URL — use relative path to trigger CRA proxy\r\nconst API_BASE_URL = '/api/v1';\r\n\r\nclass ApiService {\r\n    constructor() {\r\n        this.token = localStorage.getItem('token');\r\n    }\r\n\r\n    setToken(token) {\r\n        this.token = token;\r\n        localStorage.setItem('token', token);\r\n    }\r\n\r\n    getAuthHeaders() {\r\n        return {\r\n            'Content-Type': 'application/json',\r\n            ...(this.token && { 'Authorization': `Bearer ${this.token}` }),\r\n        };\r\n    }\r\n\r\n    async handleResponse(response) {\r\n        const text = await response.text();\r\n        let data;\r\n        try {\r\n            data = text ? JSON.parse(text) : {};\r\n        } catch {\r\n            data = {};\r\n        }\r\n\r\n        if (!response.ok) {\r\n            throw {\r\n                status: response.status,\r\n                message: data?.detail || 'An error occurred',\r\n                errors: data?.detail || [],\r\n            };\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // LOGIN (backend expects query params)\r\n    async login(email, password) {\r\n        const url = new URL(`${API_BASE_URL}/users/login`, window.location.origin);\r\n        url.searchParams.append('email', email);\r\n        url.searchParams.append('password', password);\r\n\r\n        const response = await fetch(url, {\r\n            method: 'POST',\r\n            headers: this.getAuthHeaders(),\r\n        });\r\n\r\n        const data = await this.handleResponse(response);\r\n        if (data.access_token) this.setToken(data.access_token);\r\n        return data;\r\n    }\r\n\r\n    // REGISTER (backend expects JSON)\r\n    async register(fullName, email, password) {\r\n        const body = {\r\n            email,\r\n            password,\r\n            full_name: fullName || null,\r\n        };\r\n        const response = await fetch(`${API_BASE_URL}/users/register`, {\r\n            method: 'POST',\r\n            headers: this.getAuthHeaders(),\r\n            body: JSON.stringify(body),\r\n        });\r\n        return this.handleResponse(response);\r\n    }\r\n\r\n    async getCurrentUser() {\r\n        const response = await fetch(`${API_BASE_URL}/users/me`, {\r\n            method: 'GET',\r\n            headers: this.getAuthHeaders(),\r\n        });\r\n        return this.handleResponse(response);\r\n    }\r\n\r\n    async getWallets() {\r\n        const response = await fetch(`${API_BASE_URL}/wallets/`, {\r\n            method: 'GET',\r\n            headers: this.getAuthHeaders(),\r\n        });\r\n        return this.handleResponse(response);\r\n    }\r\n\r\n    async createWallet(walletData) {\r\n        const response = await fetch(`${API_BASE_URL}/wallets/`, {\r\n            method: 'POST',\r\n            headers: this.getAuthHeaders(),\r\n            body: JSON.stringify(walletData),\r\n        });\r\n        return this.handleResponse(response);\r\n    }\r\n\r\n    async getWallet(walletId) {\r\n        const response = await fetch(`${API_BASE_URL}/wallets/${walletId}`, {\r\n            method: 'GET',\r\n            headers: this.getAuthHeaders(),\r\n        });\r\n        return this.handleResponse(response);\r\n    }\r\n}\r\n\r\nexport const apiService = new ApiService();\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}